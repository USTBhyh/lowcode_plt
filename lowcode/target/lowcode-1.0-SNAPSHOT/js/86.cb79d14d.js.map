{"version":3,"file":"js/86.cb79d14d.js","mappings":"oKAIO,MAAMA,GAAaC,EAAAA,EAAAA,IAAY,WAAW,KAE/C,MAAMC,GAAMC,EAAAA,EAAAA,IAAI,wCAEhB,MAAO,CAAED,MAAK,G,4lGCFhB,MAAME,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,4NCgCA,MAAMC,GAAUL,EAAAA,EAAAA,KAEVM,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,MAGRP,GAAMC,EAAAA,EAAAA,IAAI,IAGVO,GAAWP,EAAAA,EAAAA,IAAI,CAAC,MAAQ,OAAO,QAAU,KAG/C,SAASQ,IACP,MAAMC,EAAa,GACnB,IAAI,IAAIC,KAAOH,EAASI,MAAMC,QACL,QAApBF,EAAIG,QAAQC,MAAsC,WAApBJ,EAAIG,QAAQC,MAC3CL,EAAWM,KAAK,CACdC,OAAQN,EAAIM,OACZC,MAAOP,EAAIO,MACXN,MAAOD,EAAIG,QAAQF,QAIzB,OAAOF,CACT,CAGA,SAASS,IACP,MAAMT,EAAaD,IACnBW,EAAAA,EAAAA,KAAW,aAAc,CACvBP,QAASH,IACRW,MAAMC,IACP,MAAMC,EAAMD,EAAOE,KAAKC,OAClBC,EAAmBJ,EAAOE,KAChC,IAAI,IAAIG,EAAI,EAAGA,EAAIJ,EAAKI,IACtBnB,EAASI,MAAMC,QAAQc,GAAGb,QAAQF,MAAQc,EAAiBC,GAAGf,KAChE,IACCgB,OAAOC,IACRC,QAAQC,IAAIF,EAAM,GAEtB,CAGA,SAASG,IACP,MAAMtB,EAAaD,IACbwB,EAAiBC,KAAKC,UAAUzB,GACtCU,EAAAA,EAAAA,KAAW,cAAe,CACxBpB,IAAKA,EACLU,WAAYuB,IAEXZ,MAAMC,IACLlB,EAAOY,KAAK,CAAEoB,KAAM,oBAAqB,IACxCR,OAAOS,IACRP,QAAQC,IAAIM,EAAI,GAEtB,C,OAGAC,EAAAA,EAAAA,KAAc,KAEZtC,EAAIY,MAAQT,EAAQH,IAAM,4BAA8BM,GAAOiC,OAAOC,OAGtEpB,EAAAA,EAAAA,IAAU,cAAe,CACvBqB,OAAQ,CACNzC,IAAKA,EAAIY,SAEVS,MAAMC,IACLd,EAASI,MAAQU,EAAOE,KAEL,KAAhBF,EAAOE,MACRpB,EAAOY,KAAK,CAAEoB,KAAM,YACtB,IACCR,OAAOS,IACRP,QAAQC,IAAIM,EAAI,GAChB,I,00BC7GN,MAAMnC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://lowcode/./src/stores/httpUrl.js","webpack://lowcode/./src/components/Form/FormGenerator.vue","webpack://lowcode/./src/views/user/PublicSubmission.vue","webpack://lowcode/./src/views/user/PublicSubmission.vue?0c79"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref } from 'vue'\r\n\r\n// 公共组件\r\nexport const useHttpUrl = defineStore('httpUrl', () => {\r\n  // 运行地址\r\n  const url = ref(\"http://124.71.232.195:8080/lowcode/#\");\r\n\r\n  return { url };\r\n})","import script from \"./FormGenerator.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./FormGenerator.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./FormGenerator.vue?vue&type=style&index=0&id=6dc9a7b8&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\86153\\\\OneDrive\\\\桌面\\\\软工\\\\lowcode\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6dc9a7b8\"]])\n\nexport default __exports__","<template>\r\n  <!-- 表单填写界面 -->\r\n  <a-layout class=\"container\">\r\n    <a-layout-sider theme=\"light\" class=\"main-left\">\r\n    </a-layout-sider>\r\n    \r\n    <a-layout class=\"content\">\r\n      <a-form>\r\n        <div class=\"form-title\">\r\n          {{ formData.title }}\r\n        </div>\r\n\r\n        <a-divider></a-divider>\r\n      \r\n        <template v-for=\"(item, index) in formData.content\" :key=\"index\">\r\n          <a-form-item \r\n            class=\"item-content\" \r\n          >\r\n            <FormGenerator :element=\"item\" @refill=\"refill\"/>\r\n          </a-form-item>\r\n        </template>\r\n      </a-form>\r\n\r\n      <a-button type=\"primary\" class=\"submit-button\" @click=\"submit\"> 提交 </a-button>\r\n    </a-layout>\r\n\r\n    <a-layout-sider theme=\"light\" class=\"main-right\">\r\n    </a-layout-sider>\r\n  </a-layout>\r\n</template>\r\n\r\n<script setup>\r\nimport { onBeforeMount, ref } from \"vue\";\r\nimport FormGenerator from \"@/components/Form/FormGenerator.vue\";\r\nimport axios from \"axios\";\r\nimport { useRouter, useRoute } from 'vue-router';\r\nimport { useHttpUrl } from '@/stores/httpUrl';\r\nimport { message } from \"ant-design-vue\";\r\n\r\n// 全局 URL 前缀\r\nconst httpUrl = useHttpUrl();\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\n// 表单地址\r\nconst url = ref(\"\");\r\n\r\n// 表单信息\r\nconst formData = ref({\"title\":\"表单标题\",\"content\":[]});\r\n\r\n// 表单内容转化\r\nfunction formDataTransfer() {\r\n  const submission = [];\r\n  for(let val of formData.value.content) {\r\n    if(val.options.type != 'text' && val.options.type != 'divider') {\r\n      submission.push({\r\n        schema: val.schema,\r\n        field: val.field,\r\n        value: val.options.value,\r\n      })\r\n    }\r\n  }\r\n  return submission;\r\n}\r\n\r\n// 回填\r\nfunction refill() {\r\n  const submission = formDataTransfer();\r\n  axios.post(\"retrace.do\", {\r\n    content: submission\r\n  }).then((result) => {\r\n    const len = result.data.length;\r\n    const refilledFormData = result.data;\r\n    for(let i = 0; i < len; i++) {\r\n      formData.value.content[i].options.value = refilledFormData[i].value;\r\n    }\r\n  }).catch((error) => {\r\n    console.log(error);\r\n  });\r\n}\r\n\r\n// 表单提交\r\nfunction submit() {\r\n  const submission = formDataTransfer();\r\n  const submissionJson = JSON.stringify(submission);\r\n  axios.post('saveData.do', {\r\n    url: url,\r\n    submission: submissionJson\r\n  })\r\n    .then((result) => {\r\n      router.push({ name: \"submissionFinish\" });\r\n    }).catch((err) => {\r\n      console.log(err);\r\n    });\r\n}\r\n\r\n// 在组件被挂载前调用\r\nonBeforeMount(() => {\r\n  // httpUrl.url 在 stores => httpUrl.js 中修改\r\n  url.value = httpUrl.url + \"/user/submission/?subUrl=\" + route?.query?.subUrl;\r\n\r\n  // 请求表单信息\r\n  axios.get('formData.do', {\r\n    params: {\r\n      url: url.value\r\n    },\r\n  }).then((result) => {\r\n      formData.value = result.data;\r\n      // 该表单不存在, 跳转 404\r\n      if(result.data === \"\") {\r\n        router.push({ name: \"notFound\" });\r\n      }\r\n    }).catch((err) => {\r\n      console.log(err);\r\n    });\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  height: 100vh;\r\n  width: 100vw;\r\n}\r\n\r\n.content {\r\n  overflow-y: scroll;\r\n}\r\n\r\n.form-title {\r\n  text-align: center;\r\n  font-size: 1rem;\r\n  font-family:  Georgia, 'Times New Roman', Times, serif;\r\n  margin-top: 10px;\r\n}\r\n\r\n.item-content {\r\n  margin-left: 10px;\r\n  margin-right: 10px;  \r\n  /** 去除边框 \r\n  border: 1px dashed rgba(55, 55, 55, 0.8);\r\n  */\r\n}\r\n\r\n.submit-button {\r\n  margin: 0 auto;\r\n  width: 100px;\r\n}\r\n\r\n@media (max-width: 680px) {\r\n  .main-left,\r\n  .main-right {\r\n    display: none;\r\n  }\r\n}\r\n</style>","import script from \"./PublicSubmission.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PublicSubmission.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PublicSubmission.vue?vue&type=style&index=0&id=45215a64&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\86153\\\\OneDrive\\\\桌面\\\\软工\\\\lowcode\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-45215a64\"]])\n\nexport default __exports__"],"names":["useHttpUrl","defineStore","url","ref","__exports__","httpUrl","router","useRouter","route","useRoute","formData","formDataTransfer","submission","val","value","content","options","type","push","schema","field","refill","axios","then","result","len","data","length","refilledFormData","i","catch","error","console","log","submit","submissionJson","JSON","stringify","name","err","onBeforeMount","query","subUrl","params"],"sourceRoot":""}